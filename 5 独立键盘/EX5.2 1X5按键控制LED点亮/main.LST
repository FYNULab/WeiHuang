C51 COMPILER V9.01   MAIN                                                                  03/22/2019 11:27:42 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          
   2          /***************************************************************************************************    
   3          工程名称：      5keyAndLed
   4          功能描述：      当按下S17~S21中的任一个按键，有对应的LED被点亮
   5          硬件连接：  用8位杜邦线将J8与J13连接，
   6                      用5位杜邦线将J9_7与J7_s17、J9_6与J7_s18、J9_5与J7_s19、J9_4与J7_s20、J9_3与J7_s21
   7          维护记录：  2011-8-22
   8          ***************************************************************************************************/
   9          #include "reg51.h"       //包含头文件
  10          
  11          sbit s17=P3^7;           //定义S17按键控制IO
  12          sbit s18=P3^6;           //定义S18按键控制IO
  13          sbit s19=P3^5;           //定义S19按键控制IO
  14          sbit s20=P3^4;           //定义S20按键控制IO
  15          sbit s21=P3^3;           //定义S21按键控制IO
  16          
  17          #define uchar unsigned char
  18          #define uint  unsigned int
  19          
  20          uchar keyValue;          //定义扫描结果参数
  21          //**************************************************************************************************
  22          //延时函数
  23          //**************************************************************************************************
  24          delay(uint time)              //int型数据为16位,所以最大值为65535            
  25           {
  26   1        uint  i,j;                  //定义变量i,j,用于循环语句 
  27   1        for(i=0;i<time;i++)         //for循环,循环50*time次
  28   1           for(j=0;j<50;j++);       //for循环,循环50次
  29   1       }
  30          //**************************************************************************************************
  31          //1*5按键扫描函数
  32          //**************************************************************************************************
  33          keyScan()                             
  34           {
  35   1         P3=P3|0xf8;                //P3高5位置1，设置为输入 
  36   1         if((P3&0xf8)!=0xf8)        //判断是否有按键按下
  37   1          {
  38   2           delay(20);               //延时肖抖
  39   2           if((P3&0xf8)!=0xf8)      //再次判断是否有按键按下
  40   2             keyValue=(P3&0xf8);    //读取扫描结果
  41   2          }
  42   1       }
  43          //**************************************************************************************************
  44          //1*5按键扫描结果处理函数
  45          //**************************************************************************************************
  46          keyHandle()                     
  47           {      
  48   1              switch(keyValue)         
  49   1                {
  50   2                  case 0xb8:           //如果S17按键按下  
  51   2                                      {
  52   3                       uchar  i,j;            //定义变量i,j;
  53   3                  
  54   3                            
  55   3               j=0x01;       
C51 COMPILER V9.01   MAIN                                                                  03/22/2019 11:27:42 PAGE 2   

  56   3         for(i=0;i<8;i++)     //进入for循环,循环8次
  57   3           {
  58   4                
  59   4            P1=~j;            //依次循环点亮8位LED的1位
  60   4            delay(5000);      //延时，修改延时即可修改时间间隔 
  61   4            j<<=1;
  62   4                                 //j左移1位，j<<=1等效于j=j<<1
  63   4           }        
  64   3               break;     
  65   3                           
  66   3                      }
  67   2                  case 0x78:           //如果S18按键按下 
  68   2                                      {
  69   3                                      uchar i,j;
  70   3                                      j=0x7f;
  71   3                                      for(i=0;i<8;i++)
  72   3                                      {
  73   4                       P1=j; 
  74   4                                       delay(5000);
  75   4                                       j>>=1;
  76   4                                       P1=P1|0x80;
  77   4                                       }      //点亮一个发光二极管 
  78   3                                        P1=0x7f;         
  79   3                       break;
  80   3                      }
  81   2                  case 0xd8:           //如果S19按键按下 
  82   2                                      {
  83   3                       P1=~0x04;       //点亮一个发光二极管  
  84   3                       break;
  85   3                      }
  86   2                  case 0xe8:           //如果S20按键按下 
  87   2                                      {
  88   3                       P1=~0x08;       //点亮一个发光二极管  
  89   3                       break;
  90   3                      }
  91   2                  case 0xf0:           //如果S21按键按下 
  92   2                                      {
  93   3                       P1=~0x10;       //点亮一个发光二极管  
  94   3                       break;
  95   3                      }
  96   2                  default:
  97   2                                              break;
  98   2                }
  99   1       }
 100          //**************************************************************************************************
 101          //主函数
 102          //**************************************************************************************************
 103          void main()                   //主函数
 104          {
 105   1          
 106   1           while(1)                 //进入while死循环
 107   1            {
 108   2              keyScan();            //按键扫描
 109   2              keyHandle();          //处理扫描结果
 110   2            }         
 111   1      }
*** WARNING C290 IN LINE 29 OF MAIN.C: missing return value
*** WARNING C290 IN LINE 42 OF MAIN.C: missing return value
*** WARNING C290 IN LINE 99 OF MAIN.C: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
C51 COMPILER V9.01   MAIN                                                                  03/22/2019 11:27:42 PAGE 3   

   CODE SIZE        =    179    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  3 WARNING(S),  0 ERROR(S)
