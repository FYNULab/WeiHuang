C51 COMPILER V7.06   MAIN                                                                  07/28/2012 15:58:11 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          
   2          /***************************************************************************************************    
   3          ¹¤³ÌÃû³Æ£º      4x4key
   4          ¹¦ÄÜÃèÊö£º      ÊýÂë¹ÜÏÔÊ¾4x4¼üÅÌÉ¨ÃèµÄ½á¹û
   5          //     °´¼ü    É¨Ãè½á¹û |   °´¼ü   É¨Ãè½á¹û|  °´¼ü   É¨Ãè½á¹û |  °´¼ü   É¨Ãè½á¹û
   6          //     S1      0XEE     |   S5     0XDE    |  S9     0XBE     |  S13    0X7E
   7          //     S2      0XED     |   S6     0XDD    |  S10    0XBD     |  S14    0X7D
   8          //     S3      0XEB     |   S7     0XDB    |  S11    0XBB     |  S15    0X7B
   9          //     S4      0XE7     |   S8     0XD7    |  S12    0XB7     |  S16    0X77
  10          Ó²¼þÁ¬½Ó£º  ÓÃ8Î»¶Å°îÏß½«J8ÓëJ12Á¬½Ó£¬ÓÃ2Î»¶Å°îÏß·Ö±ð½«J11_0ÓëJ15_DS1¼°J11_1ÓëJ15_DS2Á¬½Ó£¬ÓÃ8Î»¶Å°îÏß½«J9
             -ÓëJ6Á¬½Ó
  11          Î¬»¤¼ÇÂ¼£º  2011-8-22
  12          ***************************************************************************************************/
  13          #include "reg51.h"       //°üº¬Í·ÎÄ¼þ
  14          
  15          sbit LE1=P2^0;           //Î»Ñ¡573Ëø´æÆ÷Ê¹ÄÜ
  16          sbit LE2=P2^1;           //¶ÎÑ¡573Ëø´æÆ÷Ê¹ÄÜ
  17          
  18          #define uchar unsigned char
  19          #define uint  unsigned int
  20          
  21          uchar keyValue;          //¶¨ÒåÉ¨Ãè½á¹û²ÎÊý
  22          uchar code dis[16]={0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,
  23                             //  0    1    2    3    4    5    6    7    
  24                               0x7F,0x6F,0x77,0x7C,0x39,0x5E,0x79,0x71};  //0~FµÄ¶ÎÂë
  25                             //  8    9    A    B    C    D    E    F  
  26          uchar temp;
  27          //**************************************************************************************************
  28          //ÑÓÊ±º¯Êý
  29          //**************************************************************************************************
  30          delay(uint time)              //intÐÍÊý¾ÝÎª16Î»,ËùÒÔ×î´óÖµÎª65535            
  31           {
  32   1        uint  i,j;                  //¶¨Òå±äÁ¿i,j,ÓÃÓÚÑ­»·Óï¾ä 
  33   1        for(i=0;i<time;i++)         //forÑ­»·,Ñ­»·50*time´Î
  34   1           for(j=0;j<50;j++);       //forÑ­»·,Ñ­»·50´Î
  35   1       }
  36          //**************************************************************************************************
  37          //¾ØÕó¼üÅÌÉ¨Ãèº¯Êý
  38          //**************************************************************************************************
  39          keyScan()  
  40          {
  41   1        uchar scode=0x00;//É¨ÃèÂë
  42   1        uchar rcode=0x00;//¶Á»ØÂë
  43   1        
  44   1        P3=0xf0;
  45   1        if((P3&0xf0)!=0xf0)                   //ÅÐ¶Ï¸ß4Î»ÊÇ·ñÎªÈ«1£¨¸ß4Î»È«1´ú±íÃ»°´¼ü°´ÏÂ£©
  46   1      
  47   1          {
  48   2            delay(20);                        //ÑÓÊ±È¥¶¶¶¯£¬Ò»°ãÎª5ms¡«10ms£¨ÓÉÓÚ»úÐµ´¥µãµÄµ¯ÐÔ×÷ÓÃ£¬°´¼üÔÚ±ÕºÏÊ
             -±²»»áÂíÉÏÎÈ¶¨µØ½ÓÍ¨£¬
  49   2                                                  //¶øÔÚ±ÕºÏË²¼ä°éËæÓÐÒ»Á¬´®µÄ¶¶¶¯£¬¼ü¶¶¶¯»áÒýÆðÒ»´Î°´¼ü±»Îó¶Á¶à´Î£©
  50   2            P3=0xf0;
  51   2            if((P3&0xf0)!=0xf0)               //»¹ÄÜ¼ì²âµ½ÓÐ¼üÅÌ°´ÏÂÈ¥£¬°´ÐÐÉ¨Ãè
  52   2              {
  53   3                       
C51 COMPILER V7.06   MAIN                                                                  07/28/2012 15:58:11 PAGE 2   

  54   3                scode=0xfe;                   //ÖÃÉ¨ÃèÂë
  55   3                while(scode!=0xef)            //Èç¹ûÃ»ÓÐÉ¨ÃèÍê£¬¼ÌÐøÉ¨Ãè
  56   3                   {
  57   4                     P3=scode;                //ËÍÉ¨ÃèÂë
  58   4                     if((P3&0xf0)!=0xf0)      //¼ì²âµ½ÁË
  59   4                       {
  60   5                          rcode=P3;           //±£´æP3¿ÚµÄ×´Ì¬
  61   5                          rcode=rcode & 0xf0; //Éú³É·µ»ØÂë¸ß4Î»
  62   5                          scode=scode & 0x0f; //Éú³É·µ»ØÂëµÍ4Î»
  63   5                          keyValue=scode + rcode;//·µ»Ø¼üÅÌ±àÂë, ³ÌÐòÌø³ö¼üÅÌÉ¨Ãèº¯Êý£¨³ÌÐòÖ´ÐÐµ½returnÓï¾äµÄÊ±º
             -ò¾Í·µ»Ø£¬ËûºóÃæµÄÓï¾ä¶¼²»»áÖ´ÐÐ£©¡£
  64   5                                              return keyValue;                                         
  65   5                       }
  66   4                     else
  67   4                       {
  68   5                         scode=(scode<<1)|0x01;//ÒÆÎ»£¬²úÉúÏÂÒ»ÐÐÉ¨ÃèÂë,Ë³Ðò£º0xfe>>0xfd>>0xfb>>0xf7>>0xef
  69   5                                                                                   //µ±É¨ÃèÂëÎª0xefÊ±£¬ÅÐ¶ÏÌõ¼þscode!=0xeÎª¼Ù £¬Ìø³öwhile Ñ­»·
  70   5                       }
  71   4                                      
  72   4                   }
  73   3                 return(0);  //Ã»ÓÐ¼ì²âµ½·µ»Ø0
  74   3              }
  75   2            else             //Ã»ÓÐ¼üÅÌ°´ÏÂÈ¥£¬ÉÏÒ»´ÎÊÇÒ»¸ö¸ÉÈÅ 
  76   2              {
  77   3               return(0);    //Ã»ÓÐ¼ì²âµ½·µ»Ø0
  78   3              }
  79   2          }
  80   1        else  //Ã»ÓÐ¼üÅÌ°´ÏÂÈ¥
  81   1          {
  82   2           return(0);  //Ã»ÓÐ¼ì²âµ½·µ»Ø0
  83   2          }
  84   1      }                           
  85          //**************************************************************************************************
  86          //¾ØÕó¼üÅÌÉ¨Ãè½á¹û´¦Àíº¯Êý
  87          //**************************************************************************************************
  88          uchar keyHandle(uchar value)                     
  89          {
  90   1        switch(value)
  91   1        {
  92   2         case 0xee:{return(0);break;}    //¶ÔÓ¦°´¼üS1
  93   2         case 0xde:{return(1);break;}    //¶ÔÓ¦°´¼üS2 
  94   2         case 0xbe:{return(2);break;}    //¶ÔÓ¦°´¼üS3 
  95   2         case 0x7e:{return(3);break;}    //¶ÔÓ¦°´¼üS4 
  96   2         case 0xed:{return(4);break;}    //¶ÔÓ¦°´¼üS5 
  97   2         case 0xdd:{return(5);break;}    //¶ÔÓ¦°´¼üS6 
  98   2         case 0xbd:{return(6);break;}    //¶ÔÓ¦°´¼üS7 
  99   2         case 0x7d:{return(7);break;}    //¶ÔÓ¦°´¼üS8 
 100   2         case 0xeb:{return(8);break;}    //¶ÔÓ¦°´¼üS9 
 101   2         case 0xdb:{return(9);break;}    //¶ÔÓ¦°´¼üS10        
 102   2         case 0xbb:{return(10);break;}   //¶ÔÓ¦°´¼üS11        
 103   2         case 0x7b:{return(11);break;}   //¶ÔÓ¦°´¼üS12
 104   2         case 0xe7:{return(12);break;}   //¶ÔÓ¦°´¼üS13        
 105   2         case 0xd7:{return(13);break;}   //¶ÔÓ¦°´¼üS14        
 106   2         case 0xb7:{return(14);break;}   //¶ÔÓ¦°´¼üS15        
 107   2         case 0x77:{return(15);break;}   //¶ÔÓ¦°´¼üS16
 108   2         default:{break;}     
 109   2        }
 110   1         
 111   1      }
 112          //**************************************************************************************************
 113          //ÏÔÊ¾É¨Ãè½á¹ûº¯Êý
 114          //**************************************************************************************************
C51 COMPILER V7.06   MAIN                                                                  07/28/2012 15:58:11 PAGE 3   

 115          show()                     
 116          {
 117   1           P1=0x00;             //0x00=0000 0000,¼´Ñ¡Í¨ÊýÂëÈ«8Î»
 118   1           LE1=1;               //Ëø´æÎ»
 119   1           LE1=0;               //¶Ï¿ªËø´æ,Î»Ñ¡573µÄQ7~Q0ÈÔÎª0x00
 120   1           
 121   1           P1=dis[temp];        //0~FµÄ±àÂë
 122   1           LE2=1;               //Ëø´æ¶ÎÂë
 123   1           LE2=0;               //¶Ï¿ªËø´æ,¶ÎÑ¡573µÄQ7~Q0ÈÔÎªdis[temp]   
 124   1      }
 125          
 126          //**************************************************************************************************
 127          //Ö÷º¯Êý
 128          //**************************************************************************************************
 129          void main()                        //Ö÷º¯Êý
 130          {
 131   1           while(1)                      //½øÈëwhileËÀÑ­»·
 132   1            {
 133   2              keyScan();                 //°´¼üÉ¨Ãè
 134   2              temp=keyHandle(keyValue);  //´¦ÀíÉ¨Ãè½á¹û
 135   2              show();                    //8Î»ÊýÂë¹ÜÏÔÊ¾°´¼üÖµ                
 136   2            }         
 137   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    253    ----
   CONSTANT SIZE    =     16    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2       1
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
