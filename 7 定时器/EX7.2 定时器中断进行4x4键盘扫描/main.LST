C51 COMPILER V7.06   MAIN                                                                  07/28/2012 15:58:58 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          
   2          /***************************************************************************************************    
   3          ¹¤³ÌÃû³Æ£º      4x4key_timer
   4          ¹¦ÄÜÃèÊö£º      ¶¨Ê±Æ÷ÖÐ¶Ï½øÐÐ¾ØÕó¼üÅÌÉ¨Ãè£¬ÊýÂë¹ÜÏÔÊ¾4x4¼üÅÌÉ¨ÃèµÄ½á¹û
   5          //     °´¼ü    É¨Ãè½á¹û |   °´¼ü   É¨Ãè½á¹û|  °´¼ü   É¨Ãè½á¹û |  °´¼ü   É¨Ãè½á¹û
   6          //     S1      0XEE     |   S5     0XDE    |  S9     0XBE     |  S13    0X7E
   7          //     S2      0XED     |   S6     0XDD    |  S10    0XBD     |  S14    0X7D
   8          //     S3      0XEB     |   S7     0XDB    |  S11    0XBB     |  S15    0X7B
   9          //     S4      0XE7     |   S8     0XD7    |  S12    0XB7     |  S16    0X77
  10          Ó²¼þÁ¬½Ó£º  ÓÃ8Î»¶Å°îÏß½«J8ÓëJ12Á¬½Ó£¬ÓÃ2Î»¶Å°îÏß·Ö±ð½«J11_0ÓëJ15_DS1¼°J11_1ÓëJ15_DS2Á¬½Ó£¬ÓÃ8Î»¶Å°îÏß½«J9
             -ÓëJ6Á¬½Ó
  11          Î¬»¤¼ÇÂ¼£º  2011-8-22
  12          ***************************************************************************************************/
  13          #include "reg51.h"       //°üº¬Í·ÎÄ¼þ
  14          
  15          sbit LE1=P2^0;           //Î»Ñ¡573Ëø´æÆ÷Ê¹ÄÜ
  16          sbit LE2=P2^1;           //¶ÎÑ¡573Ëø´æÆ÷Ê¹ÄÜ
  17          
  18          #define uchar unsigned char
  19          #define uint  unsigned int
  20          
  21          uchar keyValue;          //¶¨ÒåÉ¨Ãè½á¹û²ÎÊý
  22          uchar code dis[16]={0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,
  23                             //  0    1    2    3    4    5    6    7    
  24                               0x7F,0x6F,0x77,0x7C,0x39,0x5E,0x79,0x71};  //0~FµÄ¶ÎÂë
  25                             //  8    9    A    B    C    D    E    F  
  26          uchar temp;
  27          //**************************************************************************************************
  28          //ÑÓÊ±º¯Êý
  29          //**************************************************************************************************
  30          delay(uint time)              //intÐÍÊý¾ÝÎª16Î»,ËùÒÔ×î´óÖµÎª65535            
  31           {
  32   1        uint  i,j;                  //¶¨Òå±äÁ¿i,j,ÓÃÓÚÑ­»·Óï¾ä 
  33   1        for(i=0;i<time;i++)         //forÑ­»·,Ñ­»·50*time´Î
  34   1           for(j=0;j<50;j++);       //forÑ­»·,Ñ­»·50´Î
  35   1       }
  36          //**************************************************************************************************
  37          //¾ØÕó¼üÅÌÉ¨Ãèº¯Êý
  38          //**************************************************************************************************
  39          keyScan()  
  40          {
  41   1        uchar x,y; 
  42   1        P3=0xf0;                              //P3¸³Öµ0xf0
  43   1        if((P3&0xf0)!=0xf0)                   //ÅÐ¶Ï¸ß4Î»ÊÇ·ñÎªÈ«1£¨¸ß4Î»È«1´ú±íÃ»°´¼ü°´ÏÂ£©
  44   1      
  45   1          {
  46   2            delay(20);                        //ÑÓÊ±È¥¶¶¶¯£¬Ò»°ãÎª5ms¡«10ms£¨ÓÉÓÚ»úÐµ´¥µãµÄµ¯ÐÔ×÷ÓÃ£¬°´¼üÔÚ±ÕºÏÊ
             -±²»»áÂíÉÏÎÈ¶¨µØ½ÓÍ¨£¬
  47   2                                                  //¶øÔÚ±ÕºÏË²¼ä°éËæÓÐÒ»Á¬´®µÄ¶¶¶¯£¬¼ü¶¶¶¯»áÒýÆðÒ»´Î°´¼ü±»Îó¶Á¶à´Î£©
  48   2            if((P3&0xf0)!=0xf0)               //Èç¹û»¹ÄÜ¼ì²âµ½ÓÐ¼üÅÌ°´ÏÂÈ¥ 
  49   2              {
  50   3                        x=P3&0xf0;                    //¶ÁÈ¡P3¿ÚÊý¾Ý
  51   3                P3=0x0f;                      //·´×ª£¬P3¸³Öµ0x0f             
  52   3                y=P3&0x0f;                    //¶ÁÈ¡P3¿ÚÊý¾Ý
  53   3                keyValue=x|y;                 //µÃµ½É¨Ãè½á¹û
C51 COMPILER V7.06   MAIN                                                                  07/28/2012 15:58:58 PAGE 2   

  54   3              }
  55   2          }
  56   1      }                           
  57          //**************************************************************************************************
  58          //¾ØÕó¼üÅÌÉ¨Ãè½á¹û´¦Àíº¯Êý
  59          //**************************************************************************************************
  60          uchar keyHandle(uchar value)                     
  61          {
  62   1        switch(value)
  63   1        {
  64   2         case 0xee:{return(0);break;}    //¶ÔÓ¦°´¼üS1
  65   2         case 0xde:{return(1);break;}    //¶ÔÓ¦°´¼üS2 
  66   2         case 0xbe:{return(2);break;}    //¶ÔÓ¦°´¼üS3 
  67   2         case 0x7e:{return(3);break;}    //¶ÔÓ¦°´¼üS4 
  68   2         case 0xed:{return(4);break;}    //¶ÔÓ¦°´¼üS5 
  69   2         case 0xdd:{return(5);break;}    //¶ÔÓ¦°´¼üS6 
  70   2         case 0xbd:{return(6);break;}    //¶ÔÓ¦°´¼üS7 
  71   2         case 0x7d:{return(7);break;}    //¶ÔÓ¦°´¼üS8 
  72   2         case 0xeb:{return(8);break;}    //¶ÔÓ¦°´¼üS9 
  73   2         case 0xdb:{return(9);break;}    //¶ÔÓ¦°´¼üS10        
  74   2         case 0xbb:{return(10);break;}   //¶ÔÓ¦°´¼üS11        
  75   2         case 0x7b:{return(11);break;}   //¶ÔÓ¦°´¼üS12
  76   2         case 0xe7:{return(12);break;}   //¶ÔÓ¦°´¼üS13        
  77   2         case 0xd7:{return(13);break;}   //¶ÔÓ¦°´¼üS14        
  78   2         case 0xb7:{return(14);break;}   //¶ÔÓ¦°´¼üS15        
  79   2         case 0x77:{return(15);break;}   //¶ÔÓ¦°´¼üS16
  80   2         default:{break;}     
  81   2        }
  82   1         
  83   1      }
  84          //**************************************************************************************************
  85          //ÏÔÊ¾É¨Ãè½á¹ûº¯Êý
  86          //**************************************************************************************************
  87          show()                     
  88          {
  89   1           P1=0x00;             //0x00=0000 0000,¼´Ñ¡Í¨ÊýÂëÈ«8Î»
  90   1           LE1=1;               //Ëø´æÎ»
  91   1           LE1=0;               //¶Ï¿ªËø´æ,Î»Ñ¡573µÄQ7~Q0ÈÔÎª0x00
  92   1           
  93   1           P1=dis[temp];        //0~FµÄ±àÂë
  94   1           LE2=1;               //Ëø´æ¶ÎÂë
  95   1           LE2=0;               //¶Ï¿ªËø´æ,¶ÎÑ¡573µÄQ7~Q0ÈÔÎªdis[temp]   
  96   1      }
  97          //**************************************************************************************************
  98          //¶¨Ê±Æ÷ÖÐ¶Ï×Ó³ÌÐò
  99          //**************************************************************************************************
 100          t0() interrupt 1 using 1
 101          {
 102   1        keyScan();                 //°´¼üÉ¨Ãè
 103   1        temp=keyHandle(keyValue);  //´¦ÀíÉ¨Ãè½á¹û
 104   1        show();                    //8Î»ÊýÂë¹ÜÏÔÊ¾°´¼üÖµ  
 105   1      }
 106          //**************************************************************************************************
 107          //¶¨Ê±Æ÷ÖÐ¶Ï³õÊ¼»¯º¯Êý
 108          //**************************************************************************************************
 109          T0_init()        //É¨ÃèÆµÂÊÎª100HZ,¼´Ðè¶¨Ê±1/100=00.01s
 110          {
 111   1         TMOD=0x01;    //0b00000001  ÓÃµÄÊÇ¶¨Ê±Æ÷0£¬¹¤×÷ÔÚ·½Ê½1£¨16Î»¼Ä´æÆ÷£©
 112   1                       //ÒªÊµÏÖ¶¨Ê±50ms,(65536-T0)x12/12000000=0.01sµÃT0=15536¼´0xd8f0
 113   1         TH0=0xd8;     //×°¶¨Ê±Æ÷³õÖµ¸ß8Î»
 114   1         TL0=0xf0;     //×°¶¨Ê±Æ÷³õÖµµÍ8Î»
 115   1         TR0=1;        //Æô¶¯¶¨Ê±Æ÷0
C51 COMPILER V7.06   MAIN                                                                  07/28/2012 15:58:58 PAGE 3   

 116   1         ET0=1;        //¿ª¶¨Ê±Æ÷0ÖÐ¶Ï
 117   1         EA=1;         //¿ª×ÜÖÐ¶Ï
 118   1      }
 119          //**************************************************************************************************
 120          //Ö÷º¯Êý
 121          //**************************************************************************************************
 122          void main()                        //Ö÷º¯Êý
 123          {
 124   1           T0_init();                    //³õÊ¼»¯¶¨Ê±Æ÷ÖÐ¶Ï
 125   1           while(1);                     //½øÈëwhileËÀÑ­»·            
 126   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    252    ----
   CONSTANT SIZE    =     16    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      2    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
