C51 COMPILER V7.06   MAIN                                                                  10/08/2014 20:40:24 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN main.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE main.c BROWSE DEBUG OBJECTEXTEND

stmt level    source

   1          
   2          /***************************************************************************************************    
   3          ¹¤³ÌÃû³Æ£º      UART
   4          ¹¦ÄÜÃèÊö£º      ½ÓÊÕPC»ú·¢À´µÄÊý¾Ý£¬²¢ÏòPC»ú·µ»Ø½ÓÊÕµ½µÄÊý¾Ý£¬PC»úÉÏÊ¹ÓÃ´®¿Úµ÷ÊÔÖúÊÖ£¬²¨ÌØÂÊ1200bps,Ê¹ÓÃ·½Ê½1.
   5          Ó²¼þÁ¬½Ó£º  ÓÃ2Î»¶Å°îÏß·Ö±ð½«J9_0ÓëJ5_R1¼°J9_1ÓëJ5_D1Á¬½Ó(ÏÂÔØÍê³ÌÐòºó),ÓÃ´®¿ÚÏß½«PCºÍ¿ª·¢°åÉÏµÄ´®¿Ú1Á¬½Ó¡
             -£
   6          Î¬»¤¼ÇÂ¼£º  2011-8-22
   7          ***************************************************************************************************/
   8          #include "reg51.h"       //°üº¬Í·ÎÄ¼þ
   9          
  10          #define uchar unsigned char
  11          #define uint  unsigned int
  12           
  13          uchar ch;          //ÓÃÓÚ´æ·Å´®¿Ú½ÓÊÕµ½µÄÊý¾Ý
  14          uchar table[]="I get ";             
  15          bit read_flag= 0 ;      //È¡Êý±êÖ¾Î» 
  16          
  17          //**************************************************************************************************
  18          //³õÊ¼»¯´®¿Ú
  19          //**************************************************************************************************
  20          void init_com( void ) 
  21          
  22          { 
  23   1        SCON = 0x50;   // Éè¶¨Í¨ÐÅ·½Ê½Îª·½Ê½1£¬ÔÊÐí½ÓÊÕ£¬Ïàµ±ÓÚREN = 1; SM1 = 1;   
  24   1        PCON = 0x00;   //SMOD=0£¬¸ÃÓï¾ä¿ÉÈ¥µô
  25   1        IE |= 0x90 ;   //´ò¿ª´®¿ÚÖÐ¶Ï£¬ Ïàµ±ÓÚ EA = 1;ES = 1;  
  26   1      
  27   1        //ÒÔÏÂ4¾äÉèÖÃT1
  28   1        TMOD = 0x20;   // ¶¨Ê±Æ÷1¹¤×÷ÓÚ8Î»×Ô¶¯ÖØÔØÄ£Ê½, ÓÃÓÚ²úÉú²¨ÌØÂÊ
  29   1        TH1=0xE6;      //¶¨Ê±Æ÷0¸³³õÖµ£¬TH1=(256 - (12000000 / (32 * 12 * 1200)))=230;
  30   1        TL1=0xE6;      //TL1=(256 - (12000000 / (32 * 12 * 1200)))=230;
  31   1        TR1 = 1;       //Æô¶¯T1
  32   1       
  33   1      } 
  34          //**************************************************************************************************
  35          //´®¿ÚÖÐ¶Ïº¯Êý
  36          //**************************************************************************************************
  37          void serial () interrupt 4 using 3 
  38          
  39          { 
  40   1          if (RI) 
  41   1      
  42   1             {  
  43   2              RI = 0 ;       //´Ë²½±Ø²»¿ÉÉÙ,ÒòÎªÓ²¼þ²»ÄÜ½«ÆäÖÃ0   
  44   2              ch=SBUF;       //´ÓSBUFÖÐÈ¡³öÊý¾Ý       
  45   2              read_flag= 1 ; //¾ÍÖÃÎ»È¡Êý±êÖ¾ 
  46   2              }
  47   1      
  48   1      } 
  49          //**************************************************************************************************
  50          //´®¿Ú·¢ËÍº¯Êý
  51          //**************************************************************************************************
  52          void send_char( unsigned char ch1) 
  53          
  54                   {       
C51 COMPILER V7.06   MAIN                                                                  10/08/2014 20:40:24 PAGE 2   

  55   1                  SBUF=ch1;       //½«´ý·¢Êý¾Ý·Åµ½SBUF 
  56   1                  while (TI== 0); //µÈ´ýTI£½1£¨±íÊ¾Ö¡·¢ËÍ½áÊø£©·¢ËÍ
  57   1                  TI= 0 ;  
  58   1                                     //´Ë²½±Ø²»¿ÉÉÙ,ÒòÎªÓ²¼þ²»ÄÜ½«ÆäÖÃ0  
  59   1      
  60   1                } 
  61          //**************************************************************************************************
  62          //Ö÷º¯Êý
  63          //**************************************************************************************************
  64          void main(void)
  65          {   int i;
  66   1       init_com( ) ;
  67   1        
  68   1       while(1)
  69   1       {
  70   2         /*  
  71   2          ²éÑ¯·½Ê½ÊµÏÖÍ¨ÐÅ,µ±ÏµÍ³½ÏÐ¡Ê±²ÉÈ¡¡£
  72   2          Ê¹ÓÃ¸Ã·½Ê½±ØÐë½«ÏÂÃæµÄÖÐ¶Ï·½Ê½ÆÁ±Î£¬
  73   2           IE = 0x00 ;           //¹Ø±ÕËùÓÐÖÐ¶Ï£¬ÒÔ·ÀÖ¹ÖÐ¶ÏÓ°Ïì
  74   2           while(RI == 0);
  75   2           RI = 0;
  76   2           ch = SBUF;            // ´Ó»º³åÇøÖÐ°Ñ½ÓÊÕµÄ×Ö·û·ÅÈëcÖÐ
  77   2           SBUF = ch;            // Òª·¢ËÍµÄ×Ö·û·ÅÈë»º³åÇø 
  78   2           while(TI == 0);
  79   2           TI = 0;
  80   2        */
  81   2       
  82   2      
  83   2      //ÖÐ¶Ï·½Ê½ÊµÏÖÍ¨ÐÅ µ±ÏµÍ³½Ï´óÊ±²ÉÈ¡
  84   2        if (read_flag)      //Èç¹ûÈ¡Êý±êÖ¾ÒÑÖÃÎ»£¬¾Í½«¶Áµ½µÄÊý´Ó´®¿Ú·¢³ö 
  85   2      
  86   2          { 
  87   3            read_flag= 0 ;  //È¡Êý±êÖ¾Çå0
  88   3                
  89   3               
  90   3               send_char(ch);   //½«¶Áµ½µÄÊý´Ó´®¿Ú·¢³ö 
  91   3           
  92   3                 
  93   3          }
  94   2               
  95   2       } 
  96   1      
  97   1      } 
*** WARNING C280 IN LINE 65 OF MAIN.C: 'i': unreferenced local variable


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     55    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      8       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      1    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  1 WARNING(S),  0 ERROR(S)
