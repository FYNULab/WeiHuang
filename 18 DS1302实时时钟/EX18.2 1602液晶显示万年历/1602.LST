C51 COMPILER V9.01   1602                                                                  12/10/2015 11:44:53 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE 1602
OBJECT MODULE PLACED IN 1602.OBJ
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE 1602.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          
   2          /***************************************************************************************************    
   3          工程名称：      1602
   4          功能描述：  实现1602液晶显示，液晶第一行显示"  Welocome  To  "，第二行显示" www.hrbnbc.com "。
   5          硬件连接：  将1602液晶接口对应插接到P4接口，注意1-16脚不要插反（有些厂家的液晶顺序是反的）。
   6          维护记录：  2011-8-22
   7          ***************************************************************************************************/
   8          #include "reg51.h"          //包含头文件
   9          #define uchar unsigned char
  10          #define uint  unsigned int
  11          
  12          sbit rs=P2^5;    //命令/数据选择
  13          sbit rw=P2^4;    //读写口
  14          sbit  e=P2^3;    //锁存控制
  15          
  16          uchar alaflag;
  17          extern uchar dtime[7][2];
  18          //**************************************************************************************************
  19          //延时函数
  20          //**************************************************************************************************
  21          delay(uint time)         //int型数据为16位,所以最大值为65535            
  22           {
  23   1        uint  i,j;             //定义变量i,j,用于循环语句 
  24   1        for(i=0;i<time;i++)    //for循环,循环50*time次
  25   1           for(j=0;j<100;j++); //for循环,循环50次
  26   1       }
  27          //**************************************************************************************************
  28          //向LCD写一命令
  29          //**************************************************************************************************
  30          wcode(uchar t)
  31          {
  32   1        rs=0;           // 写的是命令
  33   1        rw=0;           // 写状态
  34   1        e=1;            //使能
  35   1        P0=t;           //写入命令 
  36   1        delay(20);      //等待写入,如果时间太短，会导致液晶无法显示
  37   1        e=0;            //数据的锁定
  38   1      }
  39          //**************************************************************************************************
  40          //向LCD写一数据
  41          //**************************************************************************************************
  42          wdata(uchar t)
  43          {
  44   1        rs=1;          // 写的是数据
  45   1        rw=0;          // 写状态
  46   1        e=1;           //使能
  47   1        P0=t;          //写入数据
  48   1        delay(20);     //等待写入,如果时间太短，会导致液晶无法显示
  49   1        e=0;           //数据的锁定
  50   1      }
  51          //************************************************************************************
  52          //功能：LCD显示第一行
  53          //************************************************************************************
  54          xian1()
  55          {
C51 COMPILER V9.01   1602                                                                  12/10/2015 11:44:53 PAGE 2   

  56   1        uchar i;
  57   1      
  58   1        wcode(0x80);              //设置第一行显示地址
  59   1        wdata('2');                
  60   1        wdata('0');               //显示20
  61   1         for(i=0;i<2;i++)
  62   1           {
  63   2            wdata(dtime[6][i]);   //显示年        
  64   2           }
  65   1        wdata('-');               //显示"-"
  66   1      
  67   1         for(i=0;i<2;i++)
  68   1           {
  69   2            wdata(dtime[4][i]);   //显示月   
  70   2           }
  71   1         wdata('-'); 
  72   1       
  73   1         for(i=0;i<2;i++)
  74   1           {
  75   2            wdata(dtime[3][i]);   //显示日 
  76   2           }
  77   1        wcode(0x8d);              //设置第一行显示地址
  78   1        switch(dtime[5][1])       //显示星期
  79   1         {
  80   2          case 0x31:wdata('M'); wdata('o');wdata('n'); break; 
  81   2          case 0x32:wdata('T'); wdata('u');wdata('e'); break; 
  82   2          case 0x33:wdata('W'); wdata('e');wdata('d'); break; 
  83   2              case 0x34:wdata('T'); wdata('h');wdata('u'); break; 
  84   2              case 0x35:wdata('F'); wdata('r');wdata('i'); break; 
  85   2              case 0x36:wdata('S'); wdata('a');wdata('t'); break; 
  86   2              case 0x37:wdata('S'); wdata('u');wdata('n'); break;  
  87   2          default:break;
  88   2         }
  89   1      }
  90          //************************************************************************************
  91          //功能：LCD显示第二行
  92          //************************************************************************************
  93          xian2()
  94          {
  95   1         uchar i; 
  96   1         wcode(0xc0);                                     //设置第二行显示地址
  97   1         wdata('A'); wdata('l');wdata('a');wdata(':');    //显示闹钟标志Ala:    
  98   1       switch(alaflag)                                    //显示闹钟开关状态
  99   1         {
 100   2          case 1:wdata('O'); wdata('n');break;            //显示ON
 101   2          case 0:wdata('O'); wdata('f');wdata('f'); break;//显示OFF
 102   2          default:break;
 103   2         }
 104   1          wcode(0xc8);                                   //设置第二行显示地址
 105   1            for(i=0;i<2;i++)
 106   1             {
 107   2              wdata(dtime[2][i]);                        //显示小时
 108   2             }
 109   1           wdata(':');                                   //显示":"
 110   1            for(i=0;i<2;i++)
 111   1             {
 112   2              wdata(dtime[1][i]);                        //显示分钟
 113   2             }
 114   1           wdata(':');                                   //显示":"
 115   1            for(i=0;i<2;i++)
 116   1             {
 117   2              wdata(dtime[0][i]);                        //显示秒
C51 COMPILER V9.01   1602                                                                  12/10/2015 11:44:53 PAGE 3   

 118   2             }
 119   1      }
 120          //**************************************************************************************************
 121          //LCD 初始化
 122          //**************************************************************************************************
 123          InitLCD()
 124             {             
 125   1         wcode(0x01);   //清屏
 126   1         wcode(0x06);   //输入方式控制,增量光标不移位
 127   1         wcode(0x0e);   //显示开关控制
 128   1         wcode(0x38);   //功能设定:设置16x2显示，5x7显示,8位数据接口          
 129   1         }  
*** WARNING C290 IN LINE 26 OF 1602.C: missing return value
*** WARNING C290 IN LINE 38 OF 1602.C: missing return value
*** WARNING C290 IN LINE 50 OF 1602.C: missing return value
*** WARNING C290 IN LINE 89 OF 1602.C: missing return value
*** WARNING C290 IN LINE 119 OF 1602.C: missing return value
*** WARNING C290 IN LINE 129 OF 1602.C: missing return value


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    392    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      1    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  6 WARNING(S),  0 ERROR(S)
